\chapter{人脸多属性属性识别的架构}
\section{人脸属性数据库简介}
\section{人脸属性识别的单任务模型}
基于人脸属性的单任务模型STL（下称单任务模型），顾名思义就是给定一个图像，建立一个模型去对一个属性进行学习。这不仅是人脸属性识别任务中的常见做法，也是整个模式识别领域基础的框架模式，。
在早期，数据集通常只有一种属性的标注，比如之前提到的FG-NET，它包含82个目标的1002张图像，最初只有年龄属性。作为一个分类问题，一些常见的模式识别方法也被应用其中，例如主动外观模型AAM（Active  Appearance  Model），局部二值模式LBP（Local binary patterns），加窗傅立叶变换（Gabor）等，这些常规的做法，总体来讲还是遵循特征提取工程再加上分类器模型的流程，包括特征相关性的筛选，不同模型的融合等等。但是很多时候根据固定模式提取的特征往往不够具有代表性，与识别任务的关联性不够高。于是大家开始着力想寻找一些相关性更高的方法包括，Fu等将流形学习方法引入年龄估计；另外，Guo等提出了生物启发的特征方法，Hu提出了统计信息特征（Dif，Demographic informative feature）的概念；但是时至今日，CNN特征在图像领域的出色表现，让人们对于单任务模型的使用和理解有了非常大的提高，并且总结出了一套非常简练有效的的框架：
以hu的DIF方法作为对比，hu的基本框架概述如下：前端为特征提取阶段，旨在提取对属性有判别力的特征，而不是完全无监督的。后端连接一个层级式的分类器，用于属性学习。
其中有几个主要部分：DIF（Demographic informative features）特征提取，层级式分类器，人机对于单属性预测任务的对比
1）DIF特征
DIF（Demographic informative features）是基于BIF（生物启发式特征）的。比如，我们输入一个人脸部件，先用Gabor滤波器提特征（12个尺度，8个方向），再做一些池化操作，以减小特征图的数目和维度（6个尺度，8个方向），将得到的特征串成一个4280维的长向量，用来做之后的分类等任务。总体上还是一个无监督的特征处理方法。所以之后，又对此工作做了改进，旨在不仅能够抓住图像细节，还能减小冗余性，提高特征与最终识别任务的相关性。
2）层级分类器的建设
因此，我们之后又引入一些特征学习工作。我们希望从之前的特征集中提取一个特征子集，挑选出最相关的特征，比如：
学习一个新的特征子空间（如LDA）
基于Boosting的特征选择
3）人机性能对比
我们还重点研究了人和机器的性能对比，我们做了当时规模最大的数据集来衡量并对比人和机器的性能。数据集包含以下几个方面：
FG-NET，年龄估计
MORPH（2000张图片），年龄、性别、种族估计
PCSO（2000）张图片，年龄、性别、种族估计
我们在这个数据集上进行了大量的实验，得到了许多有趣结论，接下来详细介绍。


这个工作得益于作者的精心调试和改进，
年龄估计结果对比，使用FG-NET和MORPH数据集，实验显示我们的方法取得了当时最好的结果，具有最小误差，且具有非常好的演示和出色的数学模型和理论推导。
如图显示人和机器的性能对比，可以看出机器识别能力的绝对误差要小于人类。当在做年龄估计时，算法估计偏差比较平衡。而人类往往会将年龄估计偏高。这里是误差分析，我们发现，虽然总体上机器性能高于人，但是机器会犯一些偏离实际较大的低级错误，这也是很多学习算法的共同问题。年龄估计，实验表明，算法对真实年龄和人类标注的表观年龄的估计偏差并不大。总体来讲机器的表现可圈可点。

但是需要注意的是在这个过程中，技术细节较为复杂很可能一个步骤做不好就整个系统崩溃，同时因为图片数据库和过多人工干预导致了一定程度上的局部最优解，在真实场景中，难以取得良好的效果，
得益于现代神经网络的出色表现，单属性预测模型的pipeline得到了极大的简化，同时结合端到端的思想和数据的提升效果，可以很好的提升单属性模型的预测效果。

CNN算法下的单模型输出预测：


我们也做了一些相关性的相关性实验，发现整个模型的效果和时间都较之前有了很大的提升。




\section{人脸属性识别的多任务模型}
近来，很多人脸数据集都有多属性标注。比如，MORPH有年龄、性别、种族三个标注属性。香港中文大学的CelebA数据集含有40个二值属性，如头发、眉毛、鼻子、胡须、性别等。如果针对每一个属性都设计一个模型，那么其模型复杂度过大。因此，能否设计一个模型来实现多属性的识别呢？答案是肯定的，也是可行的。
方法一：标签编码

将多属性标签组合进行编码（比如，将一岁亚洲男性标记为001，将一岁非洲男性标记为002等），将多属性问题转化为分类编码问题，也就是单一属性。
局限性：
但是，对于属性数目较多的情况，这种方式会引起数据的组合爆炸。因此，该方法只适合属性数目很小的情形。
方法二：多标签回归

通过回归的方法，使预测的特征向量与Groud-truth属性向量的损失越来越小，二者趋向接近，由此得到预测的特征向量。
局限性：
在提特征阶段，虽然有几十个属性，但用的都是同样的特征，未考虑不同属性的相关性和差异性。

基于多任务的属性学习

我们更倾向于用的是多任务方式。利用属性之间的相关性，包括正相关和负相关；以及应对属性之间的异质性，比如年龄是可量化的，而种族是类别化的，这就需要不同的处理方式。



\section{人脸属性识别中的网络能力自评估模块的设计}

